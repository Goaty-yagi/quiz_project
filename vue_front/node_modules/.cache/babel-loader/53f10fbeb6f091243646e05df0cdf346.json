{"ast":null,"code":"import { router } from \"../main.js\";\nimport { mapGetters, mapActions } from 'vuex';\nimport Progress from '@/components/signin/Progress.vue';\nimport Sent from '@/components/signin/Sent.vue';\nimport ID from '@/components/signin/ID.vue';\nimport Password from '@/components/signin/Password.vue';\nimport RegisterConfirm from '@/components/signin/RegisterConfirm.vue';\nimport Registered from '@/components/signin/Registered.vue';\nimport Edit from '@/components/signin/Edit.vue';\nimport country from '../assets/country.json';\nexport default {\n  beforeRouteLeave(to, from, next) {\n    console.log(this.filled);\n\n    if (this.filled) {\n      let answer = window.confirm(\"本当に離れますか？　保存されていないデータは破棄されます。\");\n\n      if (answer) {\n        next();\n      } else {\n        next(false);\n      }\n    } else {\n      next(true);\n    }\n  },\n\n  components: {\n    Progress,\n    Sent,\n    ID,\n    Password,\n    RegisterConfirm,\n    Registered,\n    Edit\n  },\n\n  data() {\n    return {\n      step: 0,\n      userData: {\n        username: '',\n        email: '',\n        email2: '',\n        country: ''\n      },\n      viewableCountry: '',\n      nameError: null,\n      mailError: null,\n      mailInUseError: null,\n      showSent: false,\n      showProgress: true,\n      showButton: true,\n      showRegiConf: false,\n      showEdit: false,\n      showPassword: false,\n      slideIn: true,\n      slideOut: false,\n      showSellect: false,\n      countryData: country.country,\n      filled: false\n    };\n  },\n\n  updated() {\n    this.showButtonHandler();\n    this.filled = true;\n    console.log(this.$store.state.signup.username); // this.getClass()\n  },\n\n  created() {// let a = window.addEventListener(\"beforeunload\",this.confirmFun());\n    // console.log('created',a)\n  },\n\n  mounted() {\n    window.addEventListener('beforeunload', this.handleBeforeUnload);\n    this.$store.commit('handleOnSigningup'); // console.log('mounted',this.country)\n\n    this.step = this.$store.state.step;\n  },\n\n  beforeUnmount() {\n    window.removeEventListener('beforeunload', this.handleBeforeUnload);\n    this.$store.commit('stepClear');\n    this.$store.commit('handleOnSigningup');\n    this.$store.commit('fixedScrollFalse');\n  },\n\n  watch: {\n    showButton: function (v) {\n      if (v == false) {\n        this.$refs.bform.classList.add('button-hover');\n      } else {\n        this.$refs.bform.classList.remove('button-hover');\n      }\n    },\n    nameError: function (v) {\n      if (v != '') {\n        this.$refs.formName.classList.add('form-error');\n      } else {\n        this.$refs.formName.classList.remove('form-error');\n      }\n    },\n    mailError: function (v) {\n      if (v != '') {\n        this.$refs.formMail.classList.add('form-error');\n      } else {\n        this.$refs.formName.classList.remove('form-error');\n      }\n    },\n    mailInUseError: function (v) {\n      if (v != '') {\n        this.$refs.formMail.classList.add('form-error');\n      } else {\n        this.$refs.formName.classList.remove('form-error');\n      }\n    }\n  },\n  computed: mapGetters(['fixedScroll']),\n  methods: {\n    test() {\n      console.log('test');\n    },\n\n    async submitForm() {\n      // validate email\n      // console.log('clicked1')\n      this.nameError = this.userData.username.length < 21 ? '' : '@name must be less than 20 chars';\n      this.mailError = this.userData.email == this.userData.email2 ? '' : '@addresses are not the same';\n      console.log(this.nameError);\n\n      if (this.nameError == '' && this.mailError == '') {\n        await this.$store.dispatch('checkEmail', this.userData.email);\n        console.log(this.$store.state.signup.checkedEmail);\n        this.mailInUseError = this.$store.state.signup.checkedEmail ? '' : '@address is already in use';\n        console.log(this.mailInUseError);\n\n        if (this.$store.state.signup.checkedEmail == true) {\n          // this.showSentHandler()\n          this.handleSlide();\n          this.showPasswordTrue();\n          this.showProgressHandler();\n          this.$store.commit('addStep');\n          this.$store.commit('getUsername', this.userData.username);\n          this.$store.commit('getEmail', this.userData.email);\n          this.$store.commit('getEmail2', this.userData.email2);\n          this.$store.commit('getCountry', this.userData.country);\n        }\n      }\n    },\n\n    showSentHandler() {\n      this.showSent = !this.showSent;\n    },\n\n    showProgressHandler() {\n      this.showProgress = !this.showProgress;\n    },\n\n    showRegiConfHandler() {\n      this.showRegiConf = !this.showRegiConf;\n    },\n\n    showEditHandler() {\n      this.showEdit = !this.showEdit;\n    },\n\n    progressOff() {\n      this.showProgress = false;\n    },\n\n    showButtonHandler() {\n      if (this.userData.username != '' && this.userData.mail != '' && this.userData.email2 != '' && this.viewableCountry != '') {\n        this.showButton = false;\n      } else {\n        this.showButton = true;\n      }\n    },\n\n    getFilledItems(item) {\n      if (item == 'Username') {\n        if (this.$store.signup.state.username != '') {\n          this.userData.username = this.$store.signup.state.username;\n        }\n      }\n\n      if (item == 'E-mail') {\n        if (this.$store.signup.state.email != '') {\n          this.userData.email = this.$store.signup.state.email;\n        }\n      }\n\n      if (item == 'Confirm') {\n        if (this.$store.signup.state.email2 != '') {\n          this.userData.email2 = this.$store.signup.state.email2;\n        }\n      }\n\n      if (item == 'Country') {\n        if (this.$store.signup.state.country != '') {\n          this.userData.country = this.$store.signup.state.country;\n        }\n      }\n    },\n\n    showPasswordTrue() {\n      this.showPassword = true;\n    },\n\n    showPasswordFalse() {\n      this.showPassword = false;\n    },\n\n    handleSlide() {\n      this.slideOut = !this.slideOut;\n      this.slideIn = !this.slideIn; // var slide = document.getElementById('slide')\n      // slide.setAttribute('style','display:none')\n      // console.log('slide',slide)\n    },\n\n    googleLogin() {\n      this.$store.dispatch('googleLogin');\n    },\n\n    showSelectionTrue() {\n      this.showSellect = true; // this.$store.commit('showModalTrue')\n\n      this.$store.commit('fixedScrollTrue');\n    },\n\n    showSelectionFalse() {\n      this.showSellect = false; // this.$store.commit('showModalFalse')\n\n      this.$store.commit('fixedScrollFalse');\n    },\n\n    addCountry(country) {\n      this.country = this.convertCountryToTwoCode(country);\n      this.viewableCountry = country;\n      console.log('check', this.viewableCountry, this.country);\n      this.showSelectionFalse();\n    },\n\n    convertCountryToTwoCode(country) {\n      console.log('in', this.countryData.length);\n\n      for (let i = 0; i < this.countryData.length; i++) {\n        console.log('convert', this.countryData[i][i].J_name, country);\n\n        if (this.countryData[i][i].J_name == country) {\n          return this.countryData[i][i].two_code;\n        }\n      }\n    },\n\n    setCountryForEdit(country) {\n      this.viewableCountry = country;\n    },\n\n    // beforeRouteLeave (to, from, next) {\n    //     if (window.confirm(\"Do you really want to leave?\")) {\n    //         window.open(\"exit.html\", \"Thanks for Visiting!\");\n    //         console.log('yes')\n    //     }else{\n    //         console.log('no')\n    //     }\n    //     },\n    handleBeforeUnload(e) {\n      e.preventDefault();\n      alert('unko');\n      console.log('konnnichiha', e);\n      const message = \"Are you sure you want to leave? All provided data will be lost.\";\n      e.returnValue = message;\n      return e.returnValue;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAmHA,SAAQA,MAAR,QAAqB,YAArB;AACA,SAAQC,UAAR,EAAmBC,UAAnB,QAAoC,MAApC;AACA,OAAOC,QAAP,MAAqB,kCAArB;AACA,OAAOC,IAAP,MAAiB,8BAAjB;AACA,OAAOC,EAAP,MAAe,4BAAf;AACA,OAAOC,QAAP,MAAqB,kCAArB;AACA,OAAOC,eAAP,MAA4B,yCAA5B;AACA,OAAOC,UAAP,MAAuB,oCAAvB;AACA,OAAOC,IAAP,MAAiB,8BAAjB;AACA,OAAOC,OAAP,MAAoB,wBAApB;AAGA,eAAe;EACXC,gBAAe,CAAGC,EAAH,EAAOC,IAAP,EAAaC,IAAb,EAAmB;IAC9BC,OAAO,CAACC,GAAR,CAAY,KAAKC,MAAjB;;IACA,IAAG,KAAKA,MAAR,EAAe;MACX,IAAIC,MAAK,GAAIC,MAAM,CAACC,OAAP,CAAe,+BAAf,CAAb;;MACA,IAAIF,MAAJ,EAAY;QACRJ,IAAI;MACR,CAFA,MAEO;QACHA,IAAI,CAAC,KAAD,CAAJ;MACJ;IACH,CAPD,MAOK;MACDA,IAAI,CAAC,IAAD,CAAJ;IACJ;EACH,CAbU;;EAcXO,UAAU,EAAC;IACPlB,QADO;IAEPC,IAFO;IAGPC,EAHO;IAIPC,QAJO;IAKPC,eALO;IAMPC,UANO;IAOPC;EAPO,CAdA;;EAuBXa,IAAI,GAAE;IACF,OAAM;MACFC,IAAI,EAAC,CADH;MAEFC,QAAQ,EAAC;QACLC,QAAQ,EAAC,EADJ;QAELC,KAAK,EAAC,EAFD;QAGLC,MAAM,EAAC,EAHF;QAILjB,OAAO,EAAC;MAJH,CAFP;MAQFkB,eAAe,EAAC,EARd;MASFC,SAAS,EAAC,IATR;MAUFC,SAAS,EAAC,IAVR;MAWFC,cAAc,EAAC,IAXb;MAYFC,QAAQ,EAAE,KAZR;MAaFC,YAAY,EAAC,IAbX;MAcFC,UAAU,EAAC,IAdT;MAeFC,YAAY,EAAC,KAfX;MAgBFC,QAAQ,EAAC,KAhBP;MAiBFC,YAAY,EAAE,KAjBZ;MAkBFC,OAAO,EAAC,IAlBN;MAmBFC,QAAQ,EAAC,KAnBP;MAoBFC,WAAW,EAAC,KApBV;MAqBFC,WAAW,EAAC/B,OAAO,CAACA,OArBlB;MAsBFO,MAAM,EAAE;IAtBN,CAAN;EAwBH,CAhDU;;EAiDXyB,OAAO,GAAE;IACL,KAAKC,iBAAL;IACA,KAAK1B,MAAL,GAAY,IAAZ;IACAF,OAAO,CAACC,GAAR,CAAY,KAAK4B,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBrB,QAArC,EAHK,CAIL;EACH,CAtDU;;EAuDXsB,OAAO,GAAE,CACL;IACA;EACH,CA1DU;;EA2DXC,OAAO,GAAE;IACL7B,MAAM,CAAC8B,gBAAP,CAAwB,cAAxB,EAAuC,KAAKC,kBAA5C;IACA,KAAKN,MAAL,CAAYO,MAAZ,CAAmB,mBAAnB,EAFK,CAGL;;IACA,KAAK5B,IAAL,GAAY,KAAKqB,MAAL,CAAYC,KAAZ,CAAkBtB,IAA9B;EACH,CAhEU;;EAiEX6B,aAAa,GAAE;IACXjC,MAAM,CAACkC,mBAAP,CAA2B,cAA3B,EAA0C,KAAKH,kBAA/C;IACA,KAAKN,MAAL,CAAYO,MAAZ,CAAmB,WAAnB;IACA,KAAKP,MAAL,CAAYO,MAAZ,CAAmB,mBAAnB;IACA,KAAKP,MAAL,CAAYO,MAAZ,CAAmB,kBAAnB;EACH,CAtEU;;EAuEXG,KAAK,EAAC;IACFpB,UAAU,EAAC,UAASqB,CAAT,EAAY;MAAC,IAAIA,KAAK,KAAT,EAAgB;QAAE,KAAKC,KAAL,CAAWC,KAAX,CAAiBC,SAAjB,CAA2BC,GAA3B,CAA+B,cAA/B;MAA8C,CAAhE,MACpB;QAAC,KAAKH,KAAL,CAAWC,KAAX,CAAiBC,SAAjB,CAA2BE,MAA3B,CAAkC,cAAlC;MAAkD;IAAC,CAFtD;IAGF/B,SAAS,EAAC,UAAS0B,CAAT,EAAY;MAAC,IAAIA,KAAK,EAAT,EAAa;QAAE,KAAKC,KAAL,CAAWK,QAAX,CAAoBH,SAApB,CAA8BC,GAA9B,CAAkC,YAAlC;MAA+C,CAA9D,MACnB;QAAC,KAAKH,KAAL,CAAWK,QAAX,CAAoBH,SAApB,CAA8BE,MAA9B,CAAqC,YAArC;MAAmD;IAAC,CAJvD;IAKF9B,SAAS,EAAC,UAASyB,CAAT,EAAY;MAAC,IAAIA,KAAK,EAAT,EAAa;QAAE,KAAKC,KAAL,CAAWM,QAAX,CAAoBJ,SAApB,CAA8BC,GAA9B,CAAkC,YAAlC;MAA+C,CAA9D,MACnB;QAAC,KAAKH,KAAL,CAAWK,QAAX,CAAoBH,SAApB,CAA8BE,MAA9B,CAAqC,YAArC;MAAmD;IAAC,CANvD;IAOF7B,cAAc,EAAC,UAASwB,CAAT,EAAY;MAAC,IAAIA,KAAK,EAAT,EAAa;QAAE,KAAKC,KAAL,CAAWM,QAAX,CAAoBJ,SAApB,CAA8BC,GAA9B,CAAkC,YAAlC;MAA+C,CAA9D,MACxB;QAAC,KAAKH,KAAL,CAAWK,QAAX,CAAoBH,SAApB,CAA8BE,MAA9B,CAAqC,YAArC;MAAmD;IAAC;EARvD,CAvEK;EAiFXG,QAAQ,EAAE9D,UAAU,CAAC,CAAC,aAAD,CAAD,CAjFT;EAkFX+D,OAAO,EAAC;IACJC,IAAG,GAAK;MACVlD,OAAO,CAACC,GAAR,CAAY,MAAZ;IACD,CAHO;;IAIJ,MAAMkD,UAAN,GAAkB;MACd;MACA;MACA,KAAKrC,SAAL,GAAiB,KAAKL,QAAL,CAAcC,QAAd,CAAuB0C,MAAvB,GAAgC,EAAhC,GACjB,EADiB,GACZ,kCADL;MAEA,KAAKrC,SAAL,GAAiB,KAAKN,QAAL,CAAcE,KAAd,IAAuB,KAAKF,QAAL,CAAcG,MAArC,GACjB,EADiB,GACZ,6BADL;MAEAZ,OAAO,CAACC,GAAR,CAAY,KAAKa,SAAjB;;MACA,IAAI,KAAKA,SAAL,IAAkB,EAAlB,IAAuB,KAAKC,SAAL,IAAiB,EAA5C,EAA+C;QAC3C,MAAM,KAAKc,MAAL,CAAYwB,QAAZ,CAAqB,YAArB,EAAkC,KAAK5C,QAAL,CAAcE,KAAhD,CAAN;QACAX,OAAO,CAACC,GAAR,CAAY,KAAK4B,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBuB,YAArC;QACA,KAAKtC,cAAL,GAAsB,KAAKa,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBuB,YAAzB,GACtB,EADsB,GACjB,4BADL;QAEAtD,OAAO,CAACC,GAAR,CAAY,KAAKe,cAAjB;;QACA,IAAI,KAAKa,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBuB,YAAzB,IAAyC,IAA7C,EAAkD;UAClD;UACA,KAAKC,WAAL;UACA,KAAKC,gBAAL;UACA,KAAKC,mBAAL;UACA,KAAK5B,MAAL,CAAYO,MAAZ,CAAmB,SAAnB;UACA,KAAKP,MAAL,CAAYO,MAAZ,CAAmB,aAAnB,EAAiC,KAAK3B,QAAL,CAAcC,QAA/C;UACA,KAAKmB,MAAL,CAAYO,MAAZ,CAAmB,UAAnB,EAA8B,KAAK3B,QAAL,CAAcE,KAA5C;UACA,KAAKkB,MAAL,CAAYO,MAAZ,CAAmB,WAAnB,EAA+B,KAAK3B,QAAL,CAAcG,MAA7C;UACA,KAAKiB,MAAL,CAAYO,MAAZ,CAAmB,YAAnB,EAAgC,KAAK3B,QAAL,CAAcd,OAA9C;QACA;MACJ;IACH,CA9BG;;IA+BJ+D,eAAe,GAAE;MACb,KAAKzC,QAAL,GAAgB,CAAC,KAAKA,QAAtB;IACH,CAjCG;;IAkCJwC,mBAAmB,GAAE;MACjB,KAAKvC,YAAL,GAAoB,CAAC,KAAKA,YAA1B;IACH,CApCG;;IAqCJyC,mBAAmB,GAAE;MACjB,KAAKvC,YAAL,GAAoB,CAAC,KAAKA,YAA1B;IACH,CAvCG;;IAwCJwC,eAAe,GAAE;MACb,KAAKvC,QAAL,GAAgB,CAAC,KAAKA,QAAtB;IACH,CA1CG;;IA2CJwC,WAAW,GAAE;MACT,KAAK3C,YAAL,GAAoB,KAApB;IACH,CA7CG;;IA8CJU,iBAAiB,GAAE;MACf,IAAG,KAAKnB,QAAL,CAAcC,QAAd,IAAwB,EAAxB,IACC,KAAKD,QAAL,CAAcqD,IAAd,IAAoB,EADrB,IAEC,KAAKrD,QAAL,CAAcG,MAAd,IAAsB,EAFvB,IAGC,KAAKC,eAAL,IAAsB,EAH1B,EAG6B;QACrB,KAAKM,UAAL,GAAkB,KAAlB;MACR,CALA,MAMI;QACA,KAAKA,UAAL,GAAkB,IAAlB;MACJ;IACH,CAxDG;;IAyDJ4C,cAAc,CAACC,IAAD,EAAM;MAChB,IAAGA,IAAG,IAAK,UAAX,EAAsB;QAClB,IAAG,KAAKnC,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBpB,QAAzB,IAAoC,EAAvC,EAA0C;UACtC,KAAKD,QAAL,CAAcC,QAAd,GAAyB,KAAKmB,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBpB,QAAlD;QACJ;MACJ;;MACA,IAAGsD,IAAG,IAAK,QAAX,EAAoB;QAChB,IAAG,KAAKnC,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBnB,KAAzB,IAAiC,EAApC,EAAuC;UACnC,KAAKF,QAAL,CAAcE,KAAd,GAAsB,KAAKkB,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBnB,KAA/C;QACJ;MACJ;;MACA,IAAGqD,IAAG,IAAK,SAAX,EAAqB;QACjB,IAAG,KAAKnC,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBlB,MAAzB,IAAkC,EAArC,EAAwC;UACpC,KAAKH,QAAL,CAAcG,MAAd,GAAuB,KAAKiB,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBlB,MAAhD;QACJ;MACJ;;MACA,IAAGoD,IAAG,IAAK,SAAX,EAAqB;QACjB,IAAG,KAAKnC,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBnC,OAAzB,IAAmC,EAAtC,EAAyC;UACrC,KAAKc,QAAL,CAAcd,OAAd,GAAwB,KAAKkC,MAAL,CAAYE,MAAZ,CAAmBD,KAAnB,CAAyBnC,OAAjD;QACJ;MACJ;IACH,CA9EG;;IA+EJ6D,gBAAgB,GAAE;MACd,KAAKlC,YAAL,GAAoB,IAApB;IACH,CAjFG;;IAkFJ2C,iBAAiB,GAAE;MACf,KAAK3C,YAAL,GAAoB,KAApB;IACH,CApFG;;IAqFJiC,WAAW,GAAE;MACT,KAAK/B,QAAL,GAAgB,CAAC,KAAKA,QAAtB;MACA,KAAKD,OAAL,GAAe,CAAC,KAAKA,OAArB,CAFS,CAGT;MACA;MACA;IACH,CA3FG;;IA4FJ2C,WAAW,GAAE;MACT,KAAKrC,MAAL,CAAYwB,QAAZ,CAAqB,aAArB;IACH,CA9FG;;IA+FJc,iBAAiB,GAAE;MACf,KAAK1C,WAAL,GAAmB,IAAnB,CADe,CAEf;;MACA,KAAKI,MAAL,CAAYO,MAAZ,CAAmB,iBAAnB;IACH,CAnGG;;IAoGJgC,kBAAkB,GAAE;MAChB,KAAK3C,WAAL,GAAmB,KAAnB,CADgB,CAEhB;;MACA,KAAKI,MAAL,CAAYO,MAAZ,CAAmB,kBAAnB;IACH,CAxGG;;IAyGJiC,UAAU,CAAC1E,OAAD,EAAS;MACf,KAAKA,OAAL,GAAe,KAAK2E,uBAAL,CAA6B3E,OAA7B,CAAf;MACA,KAAKkB,eAAL,GAAuBlB,OAAvB;MACAK,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAoB,KAAKY,eAAzB,EAAyC,KAAKlB,OAA9C;MACA,KAAKyE,kBAAL;IACH,CA9GG;;IA+GJE,uBAAuB,CAAC3E,OAAD,EAAS;MAC5BK,OAAO,CAACC,GAAR,CAAY,IAAZ,EAAkB,KAAKyB,WAAL,CAAiB0B,MAAnC;;MACA,KAAI,IAAImB,IAAI,CAAZ,EAAeA,CAAC,GAAC,KAAK7C,WAAL,CAAiB0B,MAAlC,EAA0CmB,CAAC,EAA3C,EAA8C;QAC1CvE,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAsB,KAAKyB,WAAL,CAAiB6C,CAAjB,EAAoBA,CAApB,EAAuBC,MAA7C,EAAoD7E,OAApD;;QACA,IAAG,KAAK+B,WAAL,CAAiB6C,CAAjB,EAAoBA,CAApB,EAAuBC,MAAvB,IAAiC7E,OAApC,EAA4C;UACxC,OAAO,KAAK+B,WAAL,CAAiB6C,CAAjB,EAAoBA,CAApB,EAAuBE,QAA9B;QACJ;MACJ;IACH,CAvHG;;IAwHJC,iBAAiB,CAAC/E,OAAD,EAAS;MACtB,KAAKkB,eAAL,GAAuBlB,OAAvB;IACH,CA1HG;;IA2HJ;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAwC,kBAAkB,CAACwC,CAAD,EAAG;MACjBA,CAAC,CAACC,cAAF;MACAC,KAAK,CAAC,MAAD,CAAL;MACA7E,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA0B0E,CAA1B;MACA,MAAMG,OAAM,GACR,iEADJ;MAEAH,CAAC,CAACI,WAAF,GAAgBD,OAAhB;MACA,OAAOH,CAAC,CAACI,WAAT;IACJ;;EA3II;AAlFG,CAAf","names":["router","mapGetters","mapActions","Progress","Sent","ID","Password","RegisterConfirm","Registered","Edit","country","beforeRouteLeave","to","from","next","console","log","filled","answer","window","confirm","components","data","step","userData","username","email","email2","viewableCountry","nameError","mailError","mailInUseError","showSent","showProgress","showButton","showRegiConf","showEdit","showPassword","slideIn","slideOut","showSellect","countryData","updated","showButtonHandler","$store","state","signup","created","mounted","addEventListener","handleBeforeUnload","commit","beforeUnmount","removeEventListener","watch","v","$refs","bform","classList","add","remove","formName","formMail","computed","methods","test","submitForm","length","dispatch","checkedEmail","handleSlide","showPasswordTrue","showProgressHandler","showSentHandler","showRegiConfHandler","showEditHandler","progressOff","mail","getFilledItems","item","showPasswordFalse","googleLogin","showSelectionTrue","showSelectionFalse","addCountry","convertCountryToTwoCode","i","J_name","two_code","setCountryForEdit","e","preventDefault","alert","message","returnValue"],"sourceRoot":"","sources":["/Users/ossan/git-clone/quiz_project/vue_front/src/views/Signup.vue"],"sourcesContent":["<template>\n    <div class=\"signin-wrapper\" :class=\"{'scroll-fixed':fixedScroll}\">\n        <div class=\"signin-container\">\n            <div class=\"flex-wrapper\">\n                <p class='title-white'>ユーザー登録</p>\n                <Progress\n                v-if='showProgress'\n                />\n            </div>\n            <div v-if=\"showSellect\" class=\"country-select\">\n                <div class='country-relative'>\n                    <div class=\"close-container\">\n                        <div @click=\"showSelectionFalse()\" class=\"close\">\n                            <i class=\"fas fa-times\"></i>\n                        </div>\n                    </div>\n                    <p class='country-title'>出身国を選んでください</p>\n                    <p v-if=\"viewableCountry\" class=\"addedCountry\">{{ viewableCountry }}</p>\n                    <div\n                    class='each-country'\n                    @click=\"addCountry(countryData[num-1][num-1].J_name)\"\n                    v-for=\"(num,countryindex) of countryData.length\"\n                    v-bind:key=\"countryindex\">\n                        <p v-if=\"userData.country!=countryData[num-1][num-1].J_name\" >{{countryData[num-1][num-1].J_name}}</p>\n                    </div>\n                </div>\n            </div>\n            <div :class=\"{'slide-in':slideIn,'slide-out':slideOut}\" id=\"slide\">\n                <form v-if='showProgress' @submit.prevent='submitForm' class=\"field-wrapper\">\n                    <div class=\"field\">\n                        <div class=\"input-box\" ref='formName'>\n                            <i class=\"fas fa-robot\" id='in-font'><input required class=\"text-box\" type='text' v-model='userData.username' id='Username' placeholder=\"Username\"></i>\n                        </div>       \n                    </div>\n                    <div class=\"field\">\n                        <div class=\"input-box\" ref='formMail'>\n                            <i class=\"far fa-envelope\" id='in-font'><input required class=\"text-box\" type='email' v-model='userData.email' id='E-mail' placeholder=\"E-mail\"></i>\n                        </div>         \n                    </div>\n                    <div class=\"field\">\n                        <div class=\"input-box\">\n                            <i class=\"far fa-envelope\" id='in-font'><input required class=\"text-box\" type='email' v-model='userData.email2' id='Confirm' placeholder=\"Confirm\"></i>\n                        </div>         \n                    </div>\n                    <div class=\"field\">\n                        <div @click=\"showSelectionTrue()\" class=\"input-box\">\n                            <input required class=\"text-box select-dammy-box\" type='text' :focus='false' v-model='viewableCountry' placeholder=\"Country\">\n                            <i class=\"fas fa-globe\" id='in-font'>                            \n                            </i>\n                            <!-- <p v-if='!country' id='infont-text'>Country</p> -->\n                            <p v-if='viewableCountry' id='infont-text'>{{ viewableCountry }}</p>\n                            <p v-if='!userData.country' class='down'>⌵</p>\n                        </div>         \n                    </div>\n                    <div v-if='mailError||nameError||mailInUseError' class='error-form'>\n                        <i class=\"fas fa-exclamation-triangle\"></i>\n                        <div v-if='mailError'>{{ mailError}}</div>\n                        <div v-if='nameError'>{{ nameError }}</div>\n                        <div v-if='mailInUseError'>{{ mailInUseError }}</div>\n                    </div>\n                    <div>\n                        <button class='fbottun' ref='bform' id=''>次へ</button>\n                    </div>\n                    <div class=\"signup-footer\">\n                        <p>アカウントをお持ちですか</p>\n                        <router-link :to=\"{ name: 'Login'}\" class=\"to-login\">ログイン画面へ移動=></router-link>\n                        <p>Googleアカウントでログイン</p>\n                        <a class=\"logo-container\">\n                            <img class=\"google\" @click=\"googleLogin()\" src=\"@/assets/btn_google.png\">\n                        </a>\n                    </div>\n                </form>\n            </div>\n            <transition name=\"slide-in\">\n                <Password\n                class=\"components\"\n                v-if='$store.state.step==2&&showPassword&&!showEdit'\n                @handle='showProgressHandler'\n                @confHandle='showRegiConfHandler'\n                />\n            </transition>\n            <transition name=\"notice\">\n                <RegisterConfirm\n                class=\"registaer-confirm\"\n                v-if='$store.state.step==2&&showRegiConf&&!showEdit&&!showSent'\n                :viewableCountry=\"viewableCountry\"\n                @handle='showProgressHandler'\n                @edithandle='showEditHandler'\n                @sentHandle='showSentHandler'\n                @showPasswordFalse='showPasswordFalse'\n                />\n            </transition>\n            <transition name=\"notice\">\n            <Sent\n                v-if='showSent&&$store.state.step==3'\n                @handle='showProgressHandler'\n                @sentHandle='showSentHandler'\n                />\n            </transition>\n            <transition name=\"slide-in\">\n                <Edit\n                    v-if='showEdit&&!showPassword'\n                    @handle='showProgressHandler'\n                    @confHandle='showRegiConfHandler'\n                    @edithandle='showEditHandler'\n                    @setCountryForEdit=\"setCountryForEdit\"\n                    :showProgress='showProgress'\n                    :viewableCountry='viewableCountry'\n                    :countryData='countryData'/>\n            </transition>\n        </div>\n    </div>\n</template>\n\n<script>\nimport {router} from \"../main.js\"\nimport {mapGetters,mapActions} from 'vuex'\nimport Progress from '@/components/signin/Progress.vue'\nimport Sent from '@/components/signin/Sent.vue'\nimport ID from '@/components/signin/ID.vue'\nimport Password from '@/components/signin/Password.vue'\nimport RegisterConfirm from '@/components/signin/RegisterConfirm.vue'\nimport Registered from '@/components/signin/Registered.vue'\nimport Edit from '@/components/signin/Edit.vue'\nimport country from '../assets/country.json';\n\n\nexport default {\n    beforeRouteLeave (to, from, next) {\n        console.log(this.filled)\n        if(this.filled){\n            let answer = window.confirm(\"本当に離れますか？　保存されていないデータは破棄されます。\")\n            if (answer) {\n                next()\n            } else {\n                next(false)\n            }\n        }else{\n            next(true)\n        }\n    },\n    components:{\n        Progress,\n        Sent,\n        ID,\n        Password,\n        RegisterConfirm,\n        Registered,\n        Edit\n    },\n    data(){\n        return{\n            step:0,\n            userData:{\n                username:'',\n                email:'',\n                email2:'',\n                country:'',\n            },\n            viewableCountry:'',\n            nameError:null,\n            mailError:null,\n            mailInUseError:null,\n            showSent: false,\n            showProgress:true,\n            showButton:true,\n            showRegiConf:false,\n            showEdit:false,\n            showPassword: false,\n            slideIn:true,\n            slideOut:false,\n            showSellect:false,\n            countryData:country.country,       \n            filled: false,  \n        }\n    },\n    updated(){\n        this.showButtonHandler()\n        this.filled=true\n        console.log(this.$store.state.signup.username)\n        // this.getClass()\n    },\n    created(){\n        // let a = window.addEventListener(\"beforeunload\",this.confirmFun());\n        // console.log('created',a)\n    },\n    mounted(){\n        window.addEventListener('beforeunload',this.handleBeforeUnload)\n        this.$store.commit('handleOnSigningup')\n        // console.log('mounted',this.country)\n        this.step = this.$store.state.step\n    },\n    beforeUnmount(){\n        window.removeEventListener('beforeunload',this.handleBeforeUnload)\n        this.$store.commit('stepClear')\n        this.$store.commit('handleOnSigningup')\n        this.$store.commit('fixedScrollFalse')\n    },\n    watch:{\n        showButton:function(v) {if (v == false) { this.$refs.bform.classList.add('button-hover')}\n        else{this.$refs.bform.classList.remove('button-hover')}},\n        nameError:function(v) {if (v != '') { this.$refs.formName.classList.add('form-error')}\n        else{this.$refs.formName.classList.remove('form-error')}},\n        mailError:function(v) {if (v != '') { this.$refs.formMail.classList.add('form-error')}\n        else{this.$refs.formName.classList.remove('form-error')}},\n        mailInUseError:function(v) {if (v != '') { this.$refs.formMail.classList.add('form-error')}\n        else{this.$refs.formName.classList.remove('form-error')}},\n    },\n    computed: mapGetters(['fixedScroll']),\n    methods:{\n        test () {\n      console.log('test')\n    },\n        async submitForm(){\n            // validate email\n            // console.log('clicked1')\n            this.nameError = this.userData.username.length < 21 ?\n            '' : '@name must be less than 20 chars'\n            this.mailError = this.userData.email == this.userData.email2 ?\n            '' : '@addresses are not the same'\n            console.log(this.nameError)\n            if (this.nameError == ''&& this.mailError ==''){\n                await this.$store.dispatch('checkEmail',this.userData.email)\n                console.log(this.$store.state.signup.checkedEmail)\n                this.mailInUseError = this.$store.state.signup.checkedEmail ?\n                '' : '@address is already in use'\n                console.log(this.mailInUseError)\n                if (this.$store.state.signup.checkedEmail == true){\n                // this.showSentHandler()\n                this.handleSlide()\n                this.showPasswordTrue()\n                this.showProgressHandler()\n                this.$store.commit('addStep')\n                this.$store.commit('getUsername',this.userData.username)\n                this.$store.commit('getEmail',this.userData.email)\n                this.$store.commit('getEmail2',this.userData.email2)\n                this.$store.commit('getCountry',this.userData.country)\n                }                \n            }\n        },\n        showSentHandler(){\n            this.showSent = !this.showSent\n        },\n        showProgressHandler(){\n            this.showProgress = !this.showProgress\n        },\n        showRegiConfHandler(){\n            this.showRegiConf = !this.showRegiConf\n        },\n        showEditHandler(){\n            this.showEdit = !this.showEdit\n        },\n        progressOff(){\n            this.showProgress = false\n        },\n        showButtonHandler(){\n            if(this.userData.username!=''&&\n                this.userData.mail!=''&&\n                this.userData.email2!=''&&\n                this.viewableCountry!=''){\n                    this.showButton = false\n            }\n            else{\n                this.showButton = true\n            }\n        },\n        getFilledItems(item){\n            if(item == 'Username'){\n                if(this.$store.signup.state.username !=''){\n                    this.userData.username = this.$store.signup.state.username\n                }\n            }\n            if(item == 'E-mail'){\n                if(this.$store.signup.state.email !=''){\n                    this.userData.email = this.$store.signup.state.email\n                }\n            }\n            if(item == 'Confirm'){\n                if(this.$store.signup.state.email2 !=''){\n                    this.userData.email2 = this.$store.signup.state.email2\n                }\n            }\n            if(item == 'Country'){\n                if(this.$store.signup.state.country !=''){\n                    this.userData.country = this.$store.signup.state.country\n                }\n            }\n        },\n        showPasswordTrue(){\n            this.showPassword = true\n        },\n        showPasswordFalse(){\n            this.showPassword = false\n        },\n        handleSlide(){\n            this.slideOut = !this.slideOut\n            this.slideIn = !this.slideIn\n            // var slide = document.getElementById('slide')\n            // slide.setAttribute('style','display:none')\n            // console.log('slide',slide)\n        },\n        googleLogin(){\n            this.$store.dispatch('googleLogin')\n        },\n        showSelectionTrue(){\n            this.showSellect = true\n            // this.$store.commit('showModalTrue')\n            this.$store.commit('fixedScrollTrue')\n        },\n        showSelectionFalse(){\n            this.showSellect = false\n            // this.$store.commit('showModalFalse')\n            this.$store.commit('fixedScrollFalse')\n        },\n        addCountry(country){\n            this.country = this.convertCountryToTwoCode(country)\n            this.viewableCountry = country\n            console.log('check',this.viewableCountry,this.country)\n            this.showSelectionFalse()\n        },\n        convertCountryToTwoCode(country){\n            console.log('in', this.countryData.length)\n            for(let i = 0; i<this.countryData.length; i++){\n                console.log('convert',this.countryData[i][i].J_name,country)\n                if(this.countryData[i][i].J_name == country){\n                    return this.countryData[i][i].two_code\n                }\n            }\n        },\n        setCountryForEdit(country){\n            this.viewableCountry = country\n        },\n        // beforeRouteLeave (to, from, next) {\n        //     if (window.confirm(\"Do you really want to leave?\")) {\n        //         window.open(\"exit.html\", \"Thanks for Visiting!\");\n        //         console.log('yes')\n        //     }else{\n        //         console.log('no')\n        //     }\n        //     },\n        handleBeforeUnload(e){\n            e.preventDefault()\n            alert('unko')\n            console.log('konnnichiha',e)\n            const message =\n                \"Are you sure you want to leave? All provided data will be lost.\";\n            e.returnValue = message;\n            return e.returnValue;\n        }\n    }\n}\n</script>\n\n<style scoped lang='scss'>\n@import \"style/_variables.scss\";\n    .signin-wrapper{\n        width:100%;\n        height: 100vh;\n        padding-top:5rem;\n        .signin-container{\n            width:100%;\n            height: 100vh;\n            position: relative;\n            flex-direction: column;\n            display: flex;\n            align-items: center;\n            .country-select{\n                position: absolute;\n                width: 85%;\n                max-width: 400px;\n                height: 75%;\n                max-height: 500px;\n                border: solid grey;\n                border-top: 0.3rem solid grey;\n                border-bottom: 0.3rem solid grey;\n                top: 2rem;\n                margin-top: 0.1rem;\n                margin-bottom: 0.5rem;\n                padding-top: 1rem;\n                padding-bottom: 1rem;\n                min-height: 5rem;\n                background: $back-tr-white;\n                transition: .5s;\n                z-index: 1;\n                overflow: scroll;\n                .country-relative{\n                    position: relative;\n                    .close-container{\n                        margin-top: -1rem;\n                        .close{\n                            // position: sticky;\n                        }\n                    }\n                    .country-title{\n                        margin-top: 1.5rem;\n                        padding-bottom: 1rem;\n                    }\n                    .addedCountry{\n                            // background: red;\n                            margin-bottom: 0.5rem;\n                            font-weight: bold;\n                            background: rgba(162, 161, 161, 0.3);\n                        }\n                    .each-country{\n                        font-size: 0.8rem;\n                        margin-top: 0.1rem;\n                        margin-bottom: 0.1rem;\n                        transition: .5s;\n                    }\n                    .each-country:hover{\n                        background: $lite-gray;\n                        \n                    }\n                }\n            }\n            .title-white{\n                margin-bottom: 1rem;\n            }\n        }\n    }\n    .signin-text{\n        color:white;\n        font-size:2rem;\n       \n    }\n    .field-wrapper{\n        // display: flex;\n        // flex-direction: column;\n        // justify-content: center;\n        margin-top:3rem;\n    }\n    .field{\n        display: flex;\n        justify-content: center;\n        align-items: center;\n    }\n    .label{\n        color:white;\n        width: 2.7rem;\n        overflow-wrap: break-word;\n        margin-right:1%;\n        line-height:1rem\n    }.label:not(:last-child) {\n        margin-bottom: initial;\n}\n    input[type=\"text\"]:focus {\n        outline: none;\n        }\n    input[type=\"email\"]:focus {\n        outline: none;\n    }\n    select:focus {\n        outline: none;\n        }\n    .input-box:focus-within{\n        border: solid $base-color;\n        \n        }\n    .input-box{\n        border: 0.12rem solid $base-color;\n        border-radius: 100vh;\n        background: $back-white;\n        width: 17rem;\n        height: 3rem;\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n        position: relative;\n        .down{\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            -webkit-transform: translate(-50%, -50%);\n            -ms-transform: translate(-50%, -50%);\n            color:rgb(75, 75, 75);\n            \n        }\n    }\n    #in-font{\n        margin-left:0.5rem;\n        color:rgb(158, 158, 158); \n        transition:0.3s;\n        position:relative;\n    }\n    #infont-text {\n        font-size: 0.8rem;\n        margin-left:0.5rem;\n        color:rgb(75, 75, 75);\n        font-weight: 450;\n        transition:0.3s;\n        font-style: italic;\n    }\n    ::placeholder {\n        font-style: italic;\n        color:rgb(75, 75, 75);\n        margin-left:0.5rem;\n        font-weight: 400;\n        transition:0.3s;\n    }\n    #in-font:focus-within{\n        color:rgb(92, 92, 92);\n\n    }\n    .text-box{\n        width: 14rem;\n        border:none;\n        background: $back-white;\n        margin-left:0.5rem;\n        position:absolute;\n        left:1rem;\n    }\n    .select-box{\n        width: 82%;\n        border:none;\n        background: $back-white;\n        margin-left:0.5rem;\n    }\n    .check-box-text{\n        color:white;\n        margin-left:1rem;\n    }\n.components{\n    display: absolute;\n}\n#slide{\n    display: absolute;\n}\n// .slide-in{\n// \ttext-align: center;\n// \topacity: 0;\n// \tanimation: slide-in-anim 1.5s ease-out forwards;\n// }\n.slide-out{\n    text-align: center;\n\topacity: 1;\n\tanimation: slide-out-anim 1.5s ease-out forwards;\n}\n.signup-footer{\n    p{\n        color: white;\n        margin-top: 0.5rem;\n        font-weight: bold;\n    }\n    .to-login:hover{\n        background: rgba(252, 252, 252, 0.3);\n        font-weight: bold;\n    }\n    .to-login{\n        display: inline-block;\n        color: $lite-gray;\n        padding: 0.2rem 0.5rem;\n        margin: 0.4rem;\n        border: solid $base-color;\n        transition: .5s;\n    }\n    .logo-container{\n        .google{\n            width: 70%;        \n        }\n    }\n}\n.select-dammy-box{\n    caret-color: transparent;\n    margin-left: 1rem;\n}\n// @keyframes slide-in-anim {\n// \t0% {\n// \t\topacity: 0;\n//         transform: translateX(-20%);\n// \t}\n// \t// 60% {\n// \t// \ttransform: translateX(-10%);\n// \t// }\n// \t// 75% {\n// \t// \ttransform: translateX(2%);\n// \t// }\n// \t100% {\n// \t\topacity: 1;\n// \t\ttransform: translateX(0);\n// \t}\n// }\n@keyframes slide-out-anim {\n\t0% {\n\t\topacity: 1;\n        transform: translateX(0);\n\t}\n\t// 60% {\n\t// \ttransform: translateX(-10%);\n\t// }\n\t// 75% {\n\t// \ttransform: translateX(2%);\n\t// }\n\t100% {\n\t\topacity: 0;\n\t\ttransform: translateX(-60%);\n        display: none;\n        \n\t}\n}\n.registaer-confirm{\n    z-index: 1;\n}\n.slide-in-enter-active {\n  animation: slide-in  ease-out 1.5s;\n}\n.slide-in-leave-active {\n  animation: slide-out ease-out 1.5s;\n}\n@keyframes slide-in {\n  0% {\n\t\topacity: 0;\n        transform: translateX(5%);\n\t}\n\t// 60% {\n\t// \ttransform: translateX(-10%);\n\t// }\n\t// 75% {\n\t// \ttransform: translateX(2%);\n\t// }\n\t100% {\n\t\topacity: 1;\n\t\ttransform: translateX(0);\n\t}\n}\n@keyframes slide-out {\n  0% {\n\t\topacity: 1;\n        transform: translateX(0);\n\t}\n\t// 60% {\n\t// \ttransform: translateX(-10%);\n\t// }\n\t// 75% {\n\t// \ttransform: translateX(2%);\n\t// }\n\t100% {\n\t\topacity: 0;\n\t\ttransform: translateX(-10%);\n\t}\n}\n@media(max-width: 629px){\n    .signin-wrapper{\n        padding-top:1rem;\n        \n    }\n}\n</style>"]},"metadata":{},"sourceType":"module"}