{"ast":null,"code":"import _regeneratorRuntime from \"/Users/ossan/git-clone/quiz_project/vue_front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/ossan/git-clone/quiz_project/vue_front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport axios from 'axios';\nimport { router } from \"/src/main.js\";\nexport default {\n  data: function data() {\n    return {\n      description: '',\n      alert: false,\n      showType: false,\n      enquireType: ['利用規約', '個人情報の取り扱い', 'クイズ', 'コミュニティ', '要望', '仕事のお問い合わせ', 'その他'],\n      form: {\n        name: '',\n        mail: '',\n        type: '',\n        text: ''\n      },\n      showError: false,\n      errorArray: [],\n      formError: {\n        occurred: false,\n        name: '名前を入力してください。',\n        longName: '名前は20字以内にしてください。',\n        mail: 'メールアドレスを入力してください。',\n        wrongMail: '正しいアドレスを入力してください。',\n        type: '問い合わせタイプを入力してください。',\n        text: '問い合わせ内容を入力してください。',\n        shortText: '20字以上入力してください。',\n        longText: '1000字以内にしてください。'\n      },\n      created: true\n    };\n  },\n  methods: {\n    createEnquire: function createEnquire() {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var logger;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return axios({\n                  method: 'post',\n                  url: '/api/enquire/',\n                  data: {\n                    'user_name': _this.form.name,\n                    'email': _this.form.mail,\n                    'enquire_type': _this.form.type,\n                    'enquire_content': _this.form.text\n                  }\n                });\n\n              case 3:\n                _context.next = 12;\n                break;\n\n              case 5:\n                _context.prev = 5;\n                _context.t0 = _context[\"catch\"](0);\n                console.log('response', _context.t0.response.status);\n                logger = {\n                  message: _this.errorMessage + \" enquire\" + \"couldn't create enquire\",\n                  path: window.location.pathname,\n                  actualErrorName: _context.t0.name,\n                  actualErrorMessage: _context.t0.message\n                };\n\n                _this.$store.commit('setLogger', logger);\n\n                _this.$store.commit('setIsLoading', false);\n\n                router.push({\n                  name: 'ConnectionError'\n                });\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 5]]);\n      }))();\n    },\n    showTypeHandle: function showTypeHandle() {\n      console.log('clicked');\n      this.showType = !this.showType;\n    },\n    getSelectType: function getSelectType(val) {\n      this.form.type = val;\n    },\n    submit: function submit() {\n      console.log(this.form, this.form['name'].length, this.validEmail(this.form['mail']));\n      this.errorArray = [];\n      this.formError.occurred = false;\n\n      for (var _i = 0, _Object$keys = Object.keys(this.form); _i < _Object$keys.length; _i++) {\n        var i = _Object$keys[_i];\n        console.log(i);\n\n        if (!this.form[i]) {\n          this.errorArray.push(this.formError[i]);\n          this.formError.occurred = true;\n        } else if (i == 'text') {\n          if (this.form[i].length < 20) {\n            this.errorArray.push(this.formError[\"shortText\"]);\n            this.formError.occurred = true;\n          } else if (this.form[i].length >= 1000) {\n            // this depends on django setting\n            this.errorArray.push(this.formError[\"LongText\"]);\n            this.formError.occurred = true;\n          }\n        } else if (i == 'mail') {\n          if (!this.validEmail(this.form[i])) {\n            this.errorArray.push(this.formError[\"wrongMail\"]);\n            this.formError.occurred = true;\n          }\n        } else if (i == 'name') {\n          if (this.form[i].length > 20) {\n            console.log('longName');\n            this.errorArray.push(this.formError[\"longName\"]);\n            this.formError.occurred = true;\n          }\n        }\n      }\n\n      if (!this.formError.occurred) {\n        this.createEnquire();\n        console.log('created');\n        this.created = true;\n        this.setTime(this.createdFalse);\n      } else {\n        this.showError = true;\n        this.setTime(this.showErrorFalse);\n      }\n    },\n    validEmail: function validEmail(email) {\n      var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n      return re.test(email);\n    },\n    showErrorFalse: function showErrorFalse() {\n      this.showError = false;\n    },\n    createdFalse: function createdFalse() {\n      this.created = false;\n    },\n    setTime: function setTime(callback) {\n      setTimeout(callback, 3000);\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","router","data","description","alert","showType","enquireType","form","name","mail","type","text","showError","errorArray","formError","occurred","longName","wrongMail","shortText","longText","created","methods","createEnquire","method","url","console","log","response","status","logger","message","errorMessage","path","window","location","pathname","actualErrorName","actualErrorMessage","$store","commit","push","showTypeHandle","getSelectType","val","submit","length","validEmail","Object","keys","i","setTime","createdFalse","showErrorFalse","email","re","test","callback","setTimeout"],"sourceRoot":"","sources":["/Users/ossan/git-clone/quiz_project/vue_front/src/views/footer-contents/Enquire.vue"],"sourcesContent":["<template>\n    <div class=\"enquire-wrapper\">\n        <div class=\"main-wrapper\">\n            <div class=\"content-wrapper\">\n                <div class=\"title-white\">\n                    <p>問い合わせ</p>\n                </div>\n                <div class=\"enquire-container\">\n                    <div class=\"enquire-title\">名前</div>\n                    <input class=\"enquire-input\" type=\"text\" v-model='form.name'>\n                </div>\n                <div class=\"enquire-container\">\n                    <div class=\"enquire-title\">メールアドレス</div>\n                    <input class=\"enquire-input\" type=\"text\" v-model='form.mail'>\n                </div>\n                <div class=\"enquire-container\">\n                    <div class=\"enquire-title\">問い合わせタイプ</div>\n                    <div class=\"enquire-type\"\n                    @click=\"showTypeHandle()\">\n                        <i\n                        v-if=\"!form.type\"\n                        class=\"fas fa-angle-down\"\n                        :class=\"{'lotate':showType}\">\n                        </i>\n                        <div v-if=\"form.type\">{{ form.type }}</div>\n                        <div v-if=\"showType\" class=\"type-select\">\n                            <div class=\"select-loop\"\n                            v-for=\"(type,typeindex) in enquireType\" \n                                v-bind:key=\"typeindex\">\n                                <p @click=\"getSelectType(type)\" class=\"type\">・{{type}}</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"enquire-container\">\n                    <div class=\"enquire-title\">問い合わせ内容</div>\n                    <textarea class=\"enquire-text\" type=\"text\" v-model='form.text'></textarea>\n                </div>\n                <div @click=\"submit()\" class=\"btn-basegra-white-db-sq\">送信する</div>\n                <div class=\"error-container\">\n                    <div v-if='showError' :class=\"{'notification-red':showError}\">\n                        <i class=\"fas fa-exclamation-triangle\"></i>\n                        <div v-for=\"(error,errorindex) in errorArray\" \n                                v-bind:key=\"errorindex\">\n                                <p>{{ error }}</p>\n                        </div>\n                    </div>\n                    <div v-if='created' class=\"l-wrapper\">\n                        <div class=\"l-container\">\n                            <p>問い合わせありがとうございました。</p>\n                            <p>もう一度問い合わせしますか。</p>\n                            <div class=\"button-container\">\n                                <div>問い合わせ<br>する</div>\n                                <div>ホームに戻る</div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- <div v-if='created' :class=\"{'notification-blue':created}\">\n                        <p>送信しました。</p>\n                    </div> -->\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport {router} from \"/src/main.js\"\n\nexport default {\n    data(){\n        return{\n            description:'',\n            alert:false,\n            showType: false,\n            enquireType: [\n                '利用規約',\n                '個人情報の取り扱い',\n                'クイズ',\n                'コミュニティ',\n                '要望',\n                '仕事のお問い合わせ',\n                'その他'\n            ],\n            form:{\n                name:'',\n                mail:'',\n                type:'',\n                text:''\n            },\n            showError: false,\n            errorArray:[],\n            formError:{\n                occurred:false,\n                name:'名前を入力してください。',\n                longName:'名前は20字以内にしてください。',\n                mail:'メールアドレスを入力してください。',\n                wrongMail:'正しいアドレスを入力してください。',\n                type:'問い合わせタイプを入力してください。',\n                text:'問い合わせ内容を入力してください。',\n                shortText:'20字以上入力してください。',\n                longText:'1000字以内にしてください。'\n            },\n            created: true,\n        }\n    },\n    methods:{\n        async createEnquire() {\n            try{\n                await axios({\n                    method: 'post',\n                    url: '/api/enquire/',                            \n                    data: {\n                        'user_name': this.form.name,\n                        'email': this.form.mail,\n                        'enquire_type': this.form.type,\n                        'enquire_content':this.form.text,\n                    },\n                })\n            } catch(e) {\n                console.log('response',e.response.status)\n                let logger = {\n                    message: this.errorMessage + \" enquire\" + \"couldn't create enquire\",\n                    path: window.location.pathname,\n                    actualErrorName: e.name,\n                    actualErrorMessage: e.message,\n                }\n                this.$store.commit('setLogger',logger)\n                this.$store.commit('setIsLoading', false)\n                router.push({ name: 'ConnectionError' })\n            }\n        },\n        showTypeHandle() {\n            console.log('clicked')\n            this.showType = !this.showType\n        },\n        getSelectType(val){\n            this.form.type = val\n        },\n        submit() {\n            console.log(this.form,this.form['name'].length,this.validEmail(this.form['mail']))\n            this.errorArray = []\n            this.formError.occurred = false\n            for(let i of Object.keys(this.form)) {\n                console.log(i)\n                if(!this.form[i]) {\n                    this.errorArray.push(this.formError[i])\n                    this.formError.occurred = true\n                }\n                else if(i == 'text') {\n                    if(this.form[i].length < 20) {\n                        this.errorArray.push(this.formError[\"shortText\"])\n                        this.formError.occurred = true\n                    } \n                    else if(this.form[i].length >= 1000) {\n                        // this depends on django setting\n                        this.errorArray.push(this.formError[\"LongText\"])\n                        this.formError.occurred = true\n\n                    }\n                }\n                else if(i == 'mail') {\n                    if(!this.validEmail(this.form[i])) {\n                        this.errorArray.push(this.formError[\"wrongMail\"])\n                        this.formError.occurred = true\n                    }\n                }\n                else if(i == 'name') {\n                    if(this.form[i].length > 20) {\n                        console.log('longName')\n                        this.errorArray.push(this.formError[\"longName\"])\n                        this.formError.occurred = true\n                    }\n                }\n\n            }\n            if(!this.formError.occurred){\n                this.createEnquire()\n                console.log('created')\n                this.created = true\n                this.setTime(this.createdFalse)\n            } else {\n                this.showError = true\n                this.setTime(this.showErrorFalse)\n            }\n        },\n        validEmail: function (email) {\n            var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n            return re.test(email);\n            },\n        showErrorFalse(){\n            this.showError = false\n        },\n        createdFalse(){\n            this.created = false\n        },\n        setTime(callback){\n            setTimeout(callback,3000)\n        }\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"style/_variables.scss\";\n\n.enquire-wrapper{\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    position: relative;\n    .main-wapper{\n    }\n}\n.content-wrapper{\n    .title-white{\n        margin-bottom: 2rem;\n    }\n    .enquire-container{\n        position: relative;\n        display: flex;\n        justify-content: center;\n        width: 100%;\n        margin-top: 1rem;\n        .enquire-title{\n            position: absolute;\n            left: 0;\n            top: 0;\n            margin-left: 5%;\n            height: 20px;\n            color: white;\n            font-weight: bold;\n            border-bottom: solid $dark-blue;\n        }\n        .enquire-input{\n            width: 90%;\n            margin-top: 25px;\n            height: 40px;\n            padding: 0.3rem;\n            font-size: 1.2rem;\n            transition: .2s;\n        }\n        .enquire-input:focus{\n            border: solid $base-color;\n        }\n        .enquire-text{\n            width: 90%;\n            margin-top: 25px;\n            height: 300px;\n            padding: 1rem;\n            margin-bottom: 1rem;\n            resize: none;\n            font-size: 1.2rem;\n            transition: .2s;\n\n        }\n        .enquire-text:focus{\n                outline: none;\n                border: solid $base-color;\n        }\n        .enquire-type{\n            position: relative;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            width: 90%;\n            margin-top: 25px;\n            height: 40px;\n            padding: 0.3rem;\n            font-size: 1.2rem;\n            transition: .2s;\n            background: white;\n            .type-select{\n                position: absolute;\n                width: 100%;\n                min-height: 80px;\n                top: 35px;\n                background: rgba(252, 252, 252, 0.95);;\n                z-index: 1;\n                .type{\n                    padding: 0.5rem 0;\n                    transition: .5s;\n                }\n                .type:hover{\n                    display: block;\n                    background: $lite-gray;\n                }\n                // .type:last-child{\n                //     padding-bottom: 0;\n                // }\n            }\n        }\n        .fa-angle-down{\n            transition: .5s;\n        }\n        .lotate{\n            transform:rotate(180deg);\n        }\n    }\n    .btn-basegra-white-db-sq{\n        padding: 0.1rem 0.5rem;\n        font-weight: bold;\n        margin-bottom: 1rem;\n    }\n    .error-container{\n        position: absolute;\n        width: 100%;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        left: 0;\n        .notification-red{\n            .fa-exclamation-triangle{\n                color: red;\n            }\n            div{\n                color: red;\n                margin-top: 0.5rem;\n                font-weight: bold;\n            }\n        }\n        .notification-blue{\n            color: blue;\n            font-weight: bold;\n        }\n    }\n}\n</style>"]},"metadata":{},"sourceType":"module"}